<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Slack Ideas</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="CAI SKI"><meta name="msapplication-TileImage" content="/img/favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="CAI SKI"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta property="og:type" content="blog"><meta property="og:title" content="Slack Ideas"><meta property="og:url" content="https://www.slackideas.com/"><meta property="og:site_name" content="Slack Ideas"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://www.slackideas.com/img/og_image.png"><meta property="article:author" content="caiski"><meta property="article:tag" content="Slack Ideas, Slack, Ideas"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.slackideas.com"},"headline":"Slack Ideas","image":["https://www.slackideas.com/img/og_image.png"],"author":{"@type":"Person","name":"caiski"},"publisher":{"@type":"Organization","name":"Slack Ideas","logo":{"@type":"ImageObject","url":"https://www.slackideas.com/about/index/logo.svg"}},"description":""}</script><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Oxanium:wght@300;400;600&amp;family=Roboto+Mono"><link rel="stylesheet" href="/css/cyberpunk.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><meta name="generator" content="Hexo 6.2.0"><link rel="alternate" href="/atom.xml" title="Slack Ideas" type="application/atom+xml">
</head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/about/index/logo.svg" alt="Slack Ideas" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2021-07-03T15:09:23.000Z" title="7/3/2021, 11:09:23 PM">2021-07-03</time>发表</span><span class="level-item"><time dateTime="2022-04-16T11:47:46.722Z" title="4/16/2022, 7:47:46 PM">2022-04-16</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/IT/">IT</a></span><span class="level-item">几秒读完 (大约37个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2021/07/03/grpc-tutorial-step-by-step/">Grpc Tutorial Step By Step</a></h1><div class="content"><h1 id="gRpc入门步骤详解"><a href="#gRpc入门步骤详解" class="headerlink" title="gRpc入门步骤详解"></a>gRpc入门步骤详解</h1><h2 id="1-安装Go-1-16、Python-3"><a href="#1-安装Go-1-16、Python-3" class="headerlink" title="1. 安装Go 1.16、Python 3"></a>1. 安装Go 1.16、Python 3</h2><pre><code>brew install go@1.16
brew install python3
</code></pre>
<h2 id="2-环境变量和其他配置"><a href="#2-环境变量和其他配置" class="headerlink" title="2. 环境变量和其他配置"></a>2. 环境变量和其他配置</h2><pre><code class="shell"># pip mirror
mkdir -p ~/.pip

cat &gt;~/.pip/pip.conf &lt;&lt;EOF
[global]
index-url = https://mirrors.aliyun.com/pypi/simple/

[install]
trusted-host=mirrors.aliyun.com
EOF

# go path
export GOPATH=/Users/apple/go
export PATH=$PATH:$GOPATH/bin
</code></pre>
<h2 id="3-安装依赖库"><a href="#3-安装依赖库" class="headerlink" title="3. 安装依赖库"></a>3. 安装依赖库</h2><pre><code># go grpc gen
go get -u github.com/golang/protobuf/protoc-gen-go

# python grpc gen
pip3 install grpcio
pip3 install protobuf
pip3 install grpcio_tools
</code></pre>
<h2 id="4-准备工程目录结构"><a href="#4-准备工程目录结构" class="headerlink" title="4. 准备工程目录结构"></a>4. 准备工程目录结构</h2><pre><code># prepare project directory
mkdir -p grpc-demo
cd grpc-demo
go mod init grpc-demo

# prepare proto-buf directory
mkdir -p pb

# prepare server directory
mkdir -p server

#prepare client directory
mkdir -p client

#prepare service directory
mkdir -p service
</code></pre>
<h2 id="5-定义-proto协议文件及生成Go代码"><a href="#5-定义-proto协议文件及生成Go代码" class="headerlink" title="5. 定义.proto协议文件及生成Go代码"></a>5. 定义.proto协议文件及生成Go代码</h2><pre><code class="proto3"># file pb/hello_grpc.proto
syntax = &quot;proto3&quot;;
package service;
option go_package = &quot;.;service&quot;;
service Greeter &#123;
  rpc SayHello (HelloRequest) returns (HelloReply) &#123;&#125;
&#125;
message HelloRequest &#123;
  string name = 1;
&#125;
message HelloReply &#123;
  string message = 1;
&#125;
</code></pre>
<p>生成Go版本的协议代码</p>
<pre><code class="shell">protoc -I pb/ pb/hello_grpc.proto --go_out=plugins=grpc:service
</code></pre>
<p><code>-I</code> 后面指定proto文件存放目录，和proto文件<br><code>--go_out=plugins=grpc:</code>后面指定生成go代码存放的目录<br>检查文件<code>service/hello_grpc.pb.go</code>是否成功生成</p>
<h2 id="6-编写Go-Server代码及运行Server"><a href="#6-编写Go-Server代码及运行Server" class="headerlink" title="6. 编写Go Server代码及运行Server"></a>6. 编写Go Server代码及运行Server</h2><pre><code class="go"># file server/server.go
package main

import (
    &quot;context&quot;
    &quot;fmt&quot;
    &quot;hello_grpc/service&quot;
    &quot;net&quot;

    &quot;google.golang.org/grpc&quot;
    &quot;google.golang.org/grpc/reflection&quot;
)

type server struct&#123;&#125;

func (s *server) SayHello(ctx context.Context, in *service.HelloRequest) (*service.HelloReply, error) &#123;
    return &amp;service.HelloReply&#123;Message: &quot;hello &quot; + in.Name&#125;, nil
&#125;

type GreeterServer interface &#123;
    SayHello(context.Context, *service.HelloRequest) (*service.HelloReply, error)
&#125;

func main() &#123;
    // listen local port
    lis, err := net.Listen(&quot;tcp&quot;, &quot;:5000&quot;)
    if err != nil &#123;
        fmt.Printf(&quot;fail to listen: %s&quot;, err)
        return
    &#125;
    // create grpc server
    s := grpc.NewServer()
    // register function
    service.RegisterGreeterServer(s, &amp;server&#123;&#125;)
    reflection.Register(s)

    err = s.Serve(lis)
    if err != nil &#123;
        fmt.Printf(&quot;fail to start server: %s&quot;, err)
        return
    &#125;
&#125;
</code></pre>
<p>运行Server，若发现报错则于项目根目录先执行<code>go mod tidy</code>准备好依赖。</p>
<pre><code>go run server/server.go
</code></pre>
<h2 id="7-编写Go-Client代码及测试Client"><a href="#7-编写Go-Client代码及测试Client" class="headerlink" title="7. 编写Go Client代码及测试Client"></a>7. 编写Go Client代码及测试Client</h2><pre><code class="go"># file client/client.go
package main

import (
    &quot;context&quot;
    &quot;fmt&quot;
    &quot;hello_grpc/service&quot;

    &quot;google.golang.org/grpc&quot;
)

func main() &#123;
    // connect server
    conn, err := grpc.Dial(&quot;:5000&quot;, grpc.WithInsecure())
    if err != nil &#123;
        fmt.Printf(&quot;fail to connect server: %s&quot;, err)
        return
    &#125;
    defer conn.Close()

    // create new client
    c := service.NewGreeterClient(conn)

    // call rpc function
    r, err := c.SayHello(context.Background(), &amp;service.HelloRequest&#123;Name: &quot;grpc&quot;&#125;)
    if err != nil &#123;
        fmt.Printf(&quot;fail to call rpc function: %s&quot;, err)
        return
    &#125;

    fmt.Printf(&quot;rpc call success: %s&quot;, r.Message)
&#125;
</code></pre>
<p>运行Client测试</p>
<pre><code>% go run client/client.go 
rpc call success: hello grpc
</code></pre>
<h2 id="8-编写Python-Client并测试Client"><a href="#8-编写Python-Client并测试Client" class="headerlink" title="8. 编写Python Client并测试Client"></a>8. 编写Python Client并测试Client</h2><p>第一步，生成Python语言协议文件<code>hello_grpc_pb2.py</code>和<code>hello_grpc_pb2_grpc.py</code></p>
<pre><code class="shell">mkdir -p python
python3 -m grpc_tools.protoc -I pb/ --python_out=python/ --grpc_python_out=python/ pb/hello_grpc.proto
</code></pre>
<p>第二步，编写Python Client</p>
<pre><code class="python"># file python/client.py
import logging

import grpc

import hello_grpc_pb2
import hello_grpc_pb2_grpc

def run():
    with grpc.insecure_channel(&#39;localhost:5000&#39;) as channel:
        stub = hello_grpc_pb2_grpc.GreeterStub(channel)
        response = stub.SayHello(hello_grpc_pb2.HelloRequest(name=&#39;grpc&#39;))
    print(&quot;call success: &#123;&#125;!&quot;.format(response.message))

if __name__ == &#39;__main__&#39;:
    logging.basicConfig()
    run()
</code></pre>
<p>第三步，运行Python Client</p>
<pre><code>% python3 python/client.py
call success: hello grpc!
</code></pre>
<h1 id="工程打包下载"><a href="#工程打包下载" class="headerlink" title="工程打包下载"></a>工程打包下载</h1><p><a href="./grpc-demo.tgz">本站地址</a></p>
<EOF>
</EOF></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2020-12-27T14:25:00.000Z" title="12/27/2020, 10:25:00 PM">2020-12-27</time>发表</span><span class="level-item"><time dateTime="2022-04-16T11:47:46.722Z" title="4/16/2022, 7:47:46 PM">2022-04-16</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/IT/">IT</a></span><span class="level-item">2 分钟读完 (大约320个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/12/27/Build-MySQL-5-7-30-With-Source-Code-On-Mac-Catalina/">Build MySQL_5.7.30 With Source Code On Mac Catalina</a></h1><div class="content"><p>在<a href="../Prepare-C-Cpp-Development-With-VSCode-On-Mac-Windows">Mac Catalina上准备好C/C++开发环境</a>后，只需要再安装<code>cmake</code>，就可以编译MySQL源码了。</p>
<pre><code class="bash">brew install cmake
</code></pre>
<h1 id="下载MySQL源码"><a href="#下载MySQL源码" class="headerlink" title="下载MySQL源码"></a>下载MySQL源码</h1><p>选择版本5.7.30（计划先看5.x，再看8.0，然后在源码层面做对比）</p>
<p>国内镜像<a target="_blank" rel="noopener" href="https://mirrors.sohu.com/mysql/MySQL-5.7/">下载地址（搜狐）</a>，选择<code>mysql-boost-5.7.30.tar.gz</code></p>
<p><code>mysql-boot</code>是指包含了C++ Boost库的MySQL源码，对于未在本地安装（或无法安装）Boost库的开发环境较为友好。</p>
<h1 id="进行编译"><a href="#进行编译" class="headerlink" title="进行编译"></a>进行编译</h1><h2 id="注意cmake参数配置"><a href="#注意cmake参数配置" class="headerlink" title="注意cmake参数配置"></a>注意<code>cmake</code>参数配置</h2><p>配置前，可以先看看<a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/mysql-sourcebuild-excerpt/5.7/en/source-configuration-options.html">官方文档的CMake配置说明</a>，对于CMake这一工具也能多些了解。</p>
<pre><code class="bash"># Specify an installation directory
PREFIX_DIR=/data/mysql-5.7.30
cmake  \
  -DCMAKE_INSTALL_PREFIX=$&#123;PREFIX_DIR&#125;  \
  -DMYSQL_DATADIR=$&#123;PREFIX_DIR&#125;/data  \
  -DSYSCONFDIR==$&#123;PREFIX_DIR&#125;/etc  \
  -DMYSQL_UNIX_ADDR=$&#123;PREFIX_DIR&#125;/etc/mysql.sock  \
  -DWITH_MYISAM_STORAGE_ENGINE=1  \
  -DWITH_INNOBASE_STORAGE_ENGINE=1  \
  -DWITH_MEMORY_STORAGE_ENGINE=1  \
  -DDEFAULT_COLLATION=utf8mb4_general_ci  \
  -DMYSQL_TCP_PORT=3306  \
  -DENABLED_LOCAL_INFILE=1  \
  -DWITH_PARTITION_STORAGE_ENGINE=1  \
  -DEXTRA_CHARSETS=all  \
  -DDEFAULT_CHARSET=utf8mb4  \
  -DENABLE_DOWNLOADS=1  \
  -DWITH_BOOST=./boost
</code></pre>
<h2 id="开始构建"><a href="#开始构建" class="headerlink" title="开始构建"></a>开始构建</h2><p>执行<code>make</code>，生成二进制文件，过程较慢，在2017版MBA 1.8GHz Dual Core i5的CPU下执行了1.3小时。</p>
<pre><code class="bash">time make
...
make  4125.91s user 289.12s system 95% cpu 1:16:48.86 total
</code></pre>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2020-12-27T06:19:00.000Z" title="12/27/2020, 2:19:00 PM">2020-12-27</time>发表</span><span class="level-item"><time dateTime="2022-04-16T11:47:46.722Z" title="4/16/2022, 7:47:46 PM">2022-04-16</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/IT/">IT</a></span><span class="level-item">4 分钟读完 (大约635个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/12/27/Prepare-C-Cpp-Development-With-VSCode-On-Mac-Windows/">Prepare C/Cpp Development With VSCode On Mac/Windows</a></h1><div class="content"><h1 id="MacOS-Catalina"><a href="#MacOS-Catalina" class="headerlink" title="MacOS Catalina"></a>MacOS Catalina</h1><ol>
<li><p>打开App Store安装Xcode直至完成</p>
</li>
<li><p>安装命令行工具 <code>xcode-select --install</code></p>
</li>
<li><p>安装VS Code <code>brew cask install visual-studio-code</code></p>
</li>
<li><p>VS Code配置</p>
<ol>
<li><p>安装”C/C++ Extension”，该过程会自动安装其依赖的相关插件</p>
</li>
<li><p>打开一个工作空间，在界面输入”Command+Shift+P”，运行”C/C++ Edit Configurations (JSON)”</p>
</li>
<li><p>在打开的配置文件中的<code>includePath</code>中添加</p>
<pre><code>&quot;/Library/Developer/CommandLineTools/usr/include/c++/v1&quot;,
&quot;/usr/local/include&quot;,
&quot;/Library/Developer/CommandLineTools/usr/lib/clang/12.0.0/include&quot;,
&quot;/Library/Developer/CommandLineTools/usr/include&quot;
</code></pre>
</li>
<li><p>在打开的配置文件中的<code>macFrameworkPath</code>中添加</p>
<pre><code>&quot;/System/Library/Frameworks&quot;,
&quot;/Library/Frameworks&quot;
</code></pre>
</li>
<li><p>在界面输入”Command+Shift+P”，运行”Tasks: Configure Task”，编辑内容如下</p>
<pre><code>&#123;
 &quot;version&quot;: &quot;2.0.0&quot;,
 &quot;tasks&quot;: [
     &#123;
         &quot;label&quot;: &quot;C++: clang++ build active file&quot;,
         &quot;command&quot;: &quot;clang++&quot;,
         &quot;type&quot;: &quot;shell&quot;,
         &quot;args&quot;: [
             &quot;-g&quot;,
             &quot;$&#123;file&#125;&quot;,
             &quot;-std=c++11&quot;,
             &quot;-o&quot;,
             &quot;$&#123;fileDirname&#125;/$&#123;fileBasenameNoExtension&#125;&quot;
         ],
         &quot;presentation&quot;: &#123;
             &quot;echo&quot;: true,
             &quot;reveal&quot;: &quot;always&quot;,
             &quot;focus&quot;: false,
             &quot;panel&quot;: &quot;shared&quot;
         &#125;
     &#125;
 ]
&#125;
</code></pre>
</li>
<li><p>在界面输入”Command+Shift+P”，运行”Debug: Open launch.json”，编辑内容如下</p>
<pre><code>&#123;
 &quot;version&quot;: &quot;0.2.0&quot;,
 &quot;configurations&quot;: [
     &#123;
         &quot;name&quot;: &quot;C/C++ Launch active file&quot;,
         &quot;type&quot;: &quot;cppdbg&quot;,
         &quot;request&quot;: &quot;launch&quot;,
         &quot;program&quot;: &quot;$&#123;fileDirname&#125;/$&#123;fileBasenameNoExtension&#125;&quot;,
         &quot;args&quot;: [],
         &quot;stopAtEntry&quot;: false,
         &quot;cwd&quot;: &quot;$&#123;workspaceFolder&#125;&quot;,
         &quot;environment&quot;: [],
         &quot;externalConsole&quot;: false,
         &quot;MIMode&quot;: &quot;lldb&quot;,
         &quot;preLaunchTask&quot;: &quot;C++: clang++ build active file&quot;
     &#125;
 ]
&#125;
</code></pre>
</li>
<li><p>新建cpp/hello.cpp文件，输入以下内容，看看智能代码提示是否生效</p>
<pre><code class="cpp">#include &lt;iostream&gt;

using namespace std;
int main() &#123;
 cout&lt;&lt;&quot;Hello&quot;&lt;&lt;endl;
&#125;
</code></pre>
</li>
<li><p>测试运行，在运行窗口可看到刚配置的”C/C++ Launch”任务，运行将弹出Terminal显示Hello以及一些辅助信息<br><img src="/2020/12/27/Prepare-C-Cpp-Development-With-VSCode-On-Mac-Windows/Launch.png"></p>
</li>
<li><p>测试调试，在cpp/hello.cpp第5行添加断点，将看到断点调试效果<br><img src="/2020/12/27/Prepare-C-Cpp-Development-With-VSCode-On-Mac-Windows/Debug.png"></p>
</li>
</ol>
</li>
</ol>
<h1 id="Windows-10"><a href="#Windows-10" class="headerlink" title="Windows 10"></a>Windows 10</h1><p>在Windows 10上搭建VS Code C/C++开发环境（基于WSL服务）</p>
<ol>
<li>按Win键搜索功能”Windows Features”</li>
<li>在弹出窗口中勾选”Windows Subsystem for Linux”项</li>
<li>打开Microsoft Store搜索Ubuntu并开始安装（也可凭个人爱好选用其他的发行版）</li>
<li>安装成功后进入启动初始化</li>
<li>初始化完成后，进入系统按需修改APT源<pre><code class="bash"># 备份配置文件
sudo cp -a /etc/apt/sources.list /etc/apt/sources.list.bak
# 使用国内源（以华为镜像源为例）
sudo sed -i &quot;s@http://.*archive.ubuntu.com@http://mirrors.huaweicloud.com@g&quot; /etc/apt/sources.list
sudo sed -i &quot;s@http://.*security.ubuntu.com@http://mirrors.huaweicloud.com@g&quot; /etc/apt/sources.list
</code></pre>
</li>
<li>安装开发所需软件<pre><code class="bash">sudo apt update
sudo apt install gcc gdb
</code></pre>
</li>
<li>从<a target="_blank" rel="noopener" href="https://code.visualstudio.com/download">官网</a>下载安装VSCode</li>
<li>VS Code配置<ol>
<li>安装”Remote WSL”插件，安装后会自动连接WSL并在WSL上下载安装VSCode Server</li>
<li>打开一个工作空间，安装”C/C++ Extension”</li>
<li>插件安装后，正常情况下会自动在空间下配置好tasks.json和launch.json</li>
<li>可进行运行和调试</li>
</ol>
</li>
</ol>
<p>至此，环境配置结束。</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2020-12-06T15:43:00.000Z" title="12/6/2020, 11:43:00 PM">2020-12-06</time>发表</span><span class="level-item"><time dateTime="2022-04-16T11:47:46.722Z" title="4/16/2022, 7:47:46 PM">2022-04-16</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/IT/">IT</a></span><span class="level-item">7 分钟读完 (大约1066个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/12/06/Dealing-With-A-MySQL-Deadlock-Problem-Caused-By-Concurrent-DML/">Dealing With A MySQL Deadlock Problem Caused By Concurrent DML</a></h1><div class="content"><h1 id="记一次由并发DML引起的MySQL死锁场景"><a href="#记一次由并发DML引起的MySQL死锁场景" class="headerlink" title="记一次由并发DML引起的MySQL死锁场景"></a>记一次由并发DML引起的MySQL死锁场景</h1><p>一次出差中，在客户现场遇到了由并发DML引起的MySQL死锁场景</p>
<h2 id="场景再现"><a href="#场景再现" class="headerlink" title="场景再现"></a>场景再现</h2><p>首先把场景重现并简化，触发条件：①事务隔离级别为InnoDB默认的REPEATABLE-READ，②有多个Session同时进行事务操作，而事务的内容是先删除一行特定记录然后重新插入该记录。</p>
<p>如下图所示：</p>
<p><img src="/2020/12/06/Dealing-With-A-MySQL-Deadlock-Problem-Caused-By-Concurrent-DML/Transaction-Deadlock-Demo.png"></p>
<p>数据库<code>show engine innodb status</code>吐出的死锁信息如下：</p>
<pre><code>------------------------
LATEST DETECTED DEADLOCK
------------------------
2020-12-06 22:14:23 0x70000ca32000
*** (1) TRANSACTION:
TRANSACTION 1563, ACTIVE 34 sec inserting
mysql tables in use 1, locked 1
LOCK WAIT 3 lock struct(s), heap size 1136, 2 row lock(s)
MySQL thread id 21, OS thread handle 123145523712000, query id 86 localhost root update
insert into tb values(1)

*** (1) HOLDS THE LOCK(S):
RECORD LOCKS space id 2 page no 4 n bits 72 index PRIMARY of table `test`.`tb` trx id 1563 lock_mode X
Record lock, heap no 1 PHYSICAL RECORD: n_fields 1; compact format; info bits 0
 0: len 8; hex 73757072656d756d; asc supremum;;


*** (1) WAITING FOR THIS LOCK TO BE GRANTED:
RECORD LOCKS space id 2 page no 4 n bits 72 index PRIMARY of table `test`.`tb` trx id 1563 lock_mode X insert intention waiting
Record lock, heap no 1 PHYSICAL RECORD: n_fields 1; compact format; info bits 0
 0: len 8; hex 73757072656d756d; asc supremum;;


*** (2) TRANSACTION:
TRANSACTION 1564, ACTIVE 21 sec inserting
mysql tables in use 1, locked 1
LOCK WAIT 3 lock struct(s), heap size 1136, 2 row lock(s)
MySQL thread id 29, OS thread handle 123145523408896, query id 87 localhost root update
insert into tb values(2)

*** (2) HOLDS THE LOCK(S):
RECORD LOCKS space id 2 page no 4 n bits 72 index PRIMARY of table `test`.`tb` trx id 1564 lock_mode X
Record lock, heap no 1 PHYSICAL RECORD: n_fields 1; compact format; info bits 0
 0: len 8; hex 73757072656d756d; asc supremum;;


*** (2) WAITING FOR THIS LOCK TO BE GRANTED:
RECORD LOCKS space id 2 page no 4 n bits 72 index PRIMARY of table `test`.`tb` trx id 1564 lock_mode X insert intention waiting
Record lock, heap no 1 PHYSICAL RECORD: n_fields 1; compact format; info bits 0
 0: len 8; hex 73757072656d756d; asc supremum;;

*** WE ROLL BACK TRANSACTION (2)
</code></pre>
<p>从死锁信息中可以看出，两个事务持有的锁是锁在相同的一块区域上：</p>
<pre><code>0: len 8; hex 73757072656d756d; asc supremum;;
</code></pre>
<h2 id="死锁分析"><a href="#死锁分析" class="headerlink" title="死锁分析"></a>死锁分析</h2><p>上面已经指出了不同的SQL语句会加什么锁，更加详细的内容可以在这里看：<a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/innodb-locks-set.html">15.7.3 Locks Set by Different SQL Statements in InnoDB</a></p>
<p>我们只看本次场景涉及到的DELETE和INSERT语句。</p>
<h3 id="DELETE语句的锁操作"><a href="#DELETE语句的锁操作" class="headerlink" title="DELETE语句的锁操作"></a>DELETE语句的锁操作</h3><pre><code>DELETE FROM ... WHERE ... sets an exclusive next-key lock on every record the search encounters. 
However, only an index record lock is required for statements that lock rows using a unique index to search for a unique row.

DELETE FROM ... WHERE ...会在所有满足条件的记录上都设置一个排他的next-key锁，即锁住之前的Gap和待删除的记录。
如果删除的数据比当前最大数据max还大，就会锁住(max, +∞)这个GAP；如果删除的数据比当前最小数据min还小，则会锁住(-∞, min)这个GAP。

不过要注意：如果待搜索字段是用唯一键搜索的，那么只会加一个Index Record Lock。
</code></pre>
<p><em>至于为何会出现+∞和-∞两个概念，请看这里<a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/internals/en/innodb-infimum-and-supremum-records.html">22.2.1.3 The Infimum and Supremum Records</a></em></p>
<h3 id="INSERT语句的锁操作"><a href="#INSERT语句的锁操作" class="headerlink" title="INSERT语句的锁操作"></a>INSERT语句的锁操作</h3><p>插入语句由于引入意向锁(Insert Intetion Lock)，会稍微复杂一些。</p>
<pre><code>INSERT sets an exclusive lock on the inserted row. This lock is an index-record lock, not a next-key lock (that is, there is no gap lock) and does not prevent other sessions from inserting into the gap before the inserted row.

INSERT 会在待插入记录上加排他锁，它是行锁而非GAP锁，并不会阻塞其他会话在该行之前的GAP插入数据。

Prior to inserting the row, a type of gap lock called an insert intention gap lock is set. This lock signals the intent to insert in such a way that multiple transactions inserting into the same index gap need not wait for each other if they are not inserting at the same position within the gap. 

但在插入之前，一个名为Insert Intention Gap Lock的GAP锁会加在待插入区域，本次场景中即为(5,+∞)区域。
</code></pre>
<h3 id="GAP锁的作用"><a href="#GAP锁的作用" class="headerlink" title="GAP锁的作用"></a>GAP锁的作用</h3><p>GAP锁作用是，防止其他事务在这个gap内的插入，但不排斥其他事务在同一个gap内加GAP锁，因此Gap X锁和Gap S锁效果相同。</p>
<h2 id="解决"><a href="#解决" class="headerlink" title="解决"></a>解决</h2><p>直接解决方法：将事务隔离级别由REPEATABLE-READ改为READ-COMMITTED。</p>
<p>因为在RR隔离级别中，读会加排他锁，而RC隔离级别中读只会加共享锁，这样可以避免出现本次场景中的互锁现象。</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2019-12-21T11:11:55.000Z" title="12/21/2019, 7:11:55 PM">2019-12-21</time>发表</span><span class="level-item"><time dateTime="2022-04-16T11:47:46.722Z" title="4/16/2022, 7:47:46 PM">2022-04-16</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/IT/">IT</a></span><span class="level-item">5 分钟读完 (大约801个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2019/12/21/The-Sequence-Of-Multi-matches-In-Regex-Expression/">The Sequence Of Multi-matches In Regex Expression</a></h1><div class="content"><h1 id="正则表达式多选结构的顺序"><a href="#正则表达式多选结构的顺序" class="headerlink" title="正则表达式多选结构的顺序"></a>正则表达式多选结构的顺序</h1><h2 id="先看一道编程题"><a href="#先看一道编程题" class="headerlink" title="先看一道编程题"></a>先看一道编程题</h2><blockquote>
<p>从一段只包含[<code>.</code>,<code>0</code>-<code>9</code>]字符的字符串中提取出全部可能的IPv4地址。</p>
<p>IPv4地址由十进制数和点来表示，每个地址包含4个十进制数，其范围为<code>0-255</code>,比如<code>172.16.254.1</code>；同时，4个十进制数不会以<code>0</code>开头，比如<code>172.16.254.01</code>是不合法的。</p>
<p>现输入一段文本<code>str=&quot;1.1.1111.16..172.16.254.1.1&quot;</code>，要求用程序答出该字符串所有子串可能形成的IPv4地址。</p>
</blockquote>
<p>很多人会想到，<code>IPv4的正则表达式我可熟悉啦，肯定能快速完成！</code>于是从网上搜索到IPv4的正则表达式，写出了以下代码：</p>
<pre><code class="java">// Java语言
import java.util.*;
import java.util.regex.*;

class Solution &#123;
    private static final Pattern IPV4_PATTERN =
            Pattern.compile(&quot;((([1-9][0-9]?)|(1[0-9]&#123;2&#125;)|(2[0-4]\\d)|(25[0-5])|0)\\.)&#123;3&#125;&quot; +
                    &quot;(([1-9][0-9]?)|(1[0-9]&#123;2&#125;)|(2[0-4]\\d)|(25[0-5])|0)&quot;);

    public Set&lt;String&gt; findAllIpv4(String input) &#123;
        Set&lt;String&gt; s = new TreeSet&lt;String&gt;();
        Matcher m = IPV4_PATTERN.matcher(input);
        int from = 0;
        while (m.find(from)) &#123;
            s.add(input.substring(m.start(), m.end()));
            from++;
        &#125;
        return s;
    &#125;
&#125;
</code></pre>
<p>我们看完这一段代码，可以确定的是：1. 正则表达式没问题，正确的IPV4地址可以用它来验证；2. Java Regex API用法也没有太大问题，基本符合预期。</p>
<pre><code>输入：0.0.0.255
输出：[0.0.0.25]
</code></pre>
<p>但这段代码的结果是不正确的，正确输出是<code>[0.0.0.2, 0.0.0.25, 0.0.0.255]</code>，原因就出在正则中多选结构<code>|</code>的用法上。</p>
<h2 id="多选结构（Alternation）"><a href="#多选结构（Alternation）" class="headerlink" title="多选结构（Alternation）"></a>多选结构（Alternation）</h2><p>多选结构在不同的正则引擎中，工作原理是截然不同的。在传统型<code>NFA</code>引擎中，会按照从左到右的顺序检查表达式中的多选分支，一旦可以匹配完成，<strong>其他的多选分支就不会尝试了</strong>。[^1]</p>
<p>以上节的正则表达式为例，我们单独摘出每个十进制数的表达式<code>(([1-9][0-9]?)|(1[0-9]&#123;2&#125;)|(2[0-4]\\d)|(25[0-5])|0)</code>，它会以如下顺序进行匹配：</p>
<pre><code>1. ([1-9][0-9]?)      # 一位数或两位数
2. (1[0-9]&#123;2&#125;)        # 位于区间[100-199]的三位数
3. (2[0-4]\\d)        # 位于区间[200-249]的三位数
4. (25[0-5])          # 位于区间[250-255]的三位数
5. 0                  # 0
</code></pre>
<p>那么在针对输入字符串<code>0.0.0.255</code>的匹配过程中，在进行第四个十进制数<code>255</code>的匹配时，会优先计算表达式<code>([1-9][0-9]?)</code>，这样可以匹配到<code>25</code>和<code>2</code>，而<code>?(question mark)</code>在正则中是一个贪婪量词[^2]，因此仅会留下<code>25</code>，所以最终我们看到了运行结果是<code>[0.0.0.25]</code>。</p>
<p>以这些知识为前提，我们可以通过<code>优先匹配多位数字，手工解析少量数字</code>的方式得到正确的解答程序，这样做的话，正则表达式需要做一些调整，将多位数匹配的多选分支放在前面，即<code>(25[0-5]|2[0-4]\\d|1\\d&#123;2&#125;|[1-9]\\d|\\d)</code>，代码如下：</p>
<pre><code class="java">// Java语言
import java.util.*;
import java.util.regex.*;

class Solution &#123;
    private static final Pattern IPV4_PATTERN =
            Pattern.compile(&quot;((25[0-5]|2[0-4]\\d|1\\d&#123;2&#125;|[1-9]\\d|\\d)\\.)&#123;3&#125;&quot; +
                    &quot;(25[0-5]|2[0-4]\\d|1\\d&#123;2&#125;|[1-9]\\d|\\d)&quot;);

    public Set&lt;String&gt; findAllIpv4(String input) &#123;
        Set&lt;String&gt; s = new TreeSet&lt;String&gt;();
        Matcher m = IPV4_PATTERN.matcher(input);
        int from = 0;
        int lastDotIdx = 0;
        String sub = null;
        while (m.find(from)) &#123;
            sub = input.substring(m.start(), m.end());
            s.add(sub);
            lastDotIdx = sub.lastIndexOf(&#39;.&#39;);
            if (lastDotIdx == sub.length() - 3) &#123;
                s.add(sub.substring(0, sub.length() - 1));
            &#125; else if (lastDotIdx == sub.length() - 4) &#123;
                s.add(sub.substring(0, sub.length() - 1));
                s.add(sub.substring(0, sub.length() - 2));
            &#125;
            from++;
        &#125;
        return s;
    &#125;
&#125;
</code></pre>
<p>[^1]: Friedl, J. E. (2006). Mastering regular expressions. “ O’Reilly Media, Inc.”, p174-p175.</p>
<p>[^2]: Friedl, J. E. (2006). Mastering regular expressions. “ O’Reilly Media, Inc.”, p142.</p>
</div></article></div><nav class="pagination" role="navigation" aria-label="pagination"><div class="pagination-previous"><a href="/">上一页</a></div><div class="pagination-next"><a href="/page/3/">下一页</a></div><ul class="pagination-list is-hidden-mobile"><li><a class="pagination-link" href="/">1</a></li><li><a class="pagination-link is-current" href="/page/2/">2</a></li><li><a class="pagination-link" href="/page/3/">3</a></li><li><span class="pagination-ellipsis">&hellip;</span></li><li><a class="pagination-link" href="/page/11/">11</a></li></ul></nav></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="/about/index/logo.svg" alt="CAISKI"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">CAISKI</p><p class="is-size-6 is-block">Engineer at Tencent Inc.</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>China</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">54</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories"><p class="title">2</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags"><p class="title">23</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/caiski" target="_blank" rel="noopener">关注我</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/caiski"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com/imskicai"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/atom.xml"><i class="fas fa-rss"></i></a></div></div></div><!--!--><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">链接</h3><ul class="menu-list"><li><a class="level is-mobile" href="/PostgresWorld" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Postgres World</span></span><span class="level-right"><span class="level-item tag">/PostgresWorld</span></span></a></li></ul></div></div></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">分类</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/IT/"><span class="level-start"><span class="level-item">IT</span></span><span class="level-end"><span class="level-item tag">35</span></span></a></li><li><a class="level is-mobile" href="/categories/Other/"><span class="level-start"><span class="level-item">Other</span></span><span class="level-end"><span class="level-item tag">18</span></span></a></li></ul></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-10-10T03:01:05.000Z">2021-10-10</time></p><p class="title"><a href="/2021/10/10/Li-Assisted-Driving-in-Long-Distance-Road-Trip/">Li Assisted Driving in Long Distance Road Trip</a></p><p class="categories"><a href="/categories/Other/">Other</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-08-22T07:16:56.000Z">2021-08-22</time></p><p class="title"><a href="/2021/08/22/Data-Type-Mappings-Between-Golang-And-PostgreSQL/">Data Type Mappings Between Golang And PostgreSQL</a></p><p class="categories"><a href="/categories/IT/">IT</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-07-18T05:16:42.000Z">2021-07-18</time></p><p class="title"><a href="/2021/07/18/A-Glance-Through-the-Window-of-Office-Two-Pictures/">A Glance Through the Window of Office (Two Pictures)</a></p><p class="categories"><a href="/categories/Other/">Other</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-07-17T12:14:17.000Z">2021-07-17</time></p><p class="title"><a href="/2021/07/17/Alfred-New-User-Notes-Part-I/">Alfred New User Notes - Part I</a></p><p class="categories"><a href="/categories/Other/">Other</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-07-03T15:09:23.000Z">2021-07-03</time></p><p class="title"><a href="/2021/07/03/Grpc-Tutorial-Step-By-Step/">Grpc Tutorial Step By Step</a></p><p class="categories"><a href="/categories/IT/">IT</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">归档</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2021/10/"><span class="level-start"><span class="level-item">十月 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/08/"><span class="level-start"><span class="level-item">八月 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/07/"><span class="level-start"><span class="level-item">七月 2021</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/12/"><span class="level-start"><span class="level-item">十二月 2020</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/12/"><span class="level-start"><span class="level-item">十二月 2019</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/11/"><span class="level-start"><span class="level-item">十一月 2019</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/05/"><span class="level-start"><span class="level-item">五月 2018</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/03/"><span class="level-start"><span class="level-item">三月 2018</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/02/"><span class="level-start"><span class="level-item">二月 2018</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/01/"><span class="level-start"><span class="level-item">一月 2018</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2017/12/"><span class="level-start"><span class="level-item">十二月 2017</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2017/08/"><span class="level-start"><span class="level-item">八月 2017</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2017/07/"><span class="level-start"><span class="level-item">七月 2017</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2017/03/"><span class="level-start"><span class="level-item">三月 2017</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2017/01/"><span class="level-start"><span class="level-item">一月 2017</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2016/12/"><span class="level-start"><span class="level-item">十二月 2016</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2016/11/"><span class="level-start"><span class="level-item">十一月 2016</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2016/10/"><span class="level-start"><span class="level-item">十月 2016</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2015/12/"><span class="level-start"><span class="level-item">十二月 2015</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2015/11/"><span class="level-start"><span class="level-item">十一月 2015</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2015/09/"><span class="level-start"><span class="level-item">九月 2015</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2015/08/"><span class="level-start"><span class="level-item">八月 2015</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2015/07/"><span class="level-start"><span class="level-item">七月 2015</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2015/06/"><span class="level-start"><span class="level-item">六月 2015</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2015/04/"><span class="level-start"><span class="level-item">四月 2015</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2014/12/"><span class="level-start"><span class="level-item">十二月 2014</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2014/09/"><span class="level-start"><span class="level-item">九月 2014</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2014/07/"><span class="level-start"><span class="level-item">七月 2014</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2013/09/"><span class="level-start"><span class="level-item">九月 2013</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2012/09/"><span class="level-start"><span class="level-item">九月 2012</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2012/07/"><span class="level-start"><span class="level-item">七月 2012</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2010/12/"><span class="level-start"><span class="level-item">十二月 2010</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2010/11/"><span class="level-start"><span class="level-item">十一月 2010</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">标签</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/alfred/"><span class="tag">alfred</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/algorithm/"><span class="tag">algorithm</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/blockchain/"><span class="tag">blockchain</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/cpp/"><span class="tag">cpp</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/design-pattern/"><span class="tag">design pattern</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/emerg/"><span class="tag">emerg</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/golang/"><span class="tag">golang</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/iptables/"><span class="tag">iptables</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/java/"><span class="tag">java</span><span class="tag">8</span></a></div><div class="control"><a class="tags has-addons" href="/tags/linux/"><span class="tag">linux</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/mac/"><span class="tag">mac</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/mysql/"><span class="tag">mysql</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/photography/"><span class="tag">photography</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/postgresql/"><span class="tag">postgresql</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/python/"><span class="tag">python</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/regex/"><span class="tag">regex</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/rpc/"><span class="tag">rpc</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/shell/"><span class="tag">shell</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ssh/"><span class="tag">ssh</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/tex/"><span class="tag">tex</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/thoughts/"><span class="tag">thoughts</span><span class="tag">10</span></a></div><div class="control"><a class="tags has-addons" href="/tags/trial/"><span class="tag">trial</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/tricks/"><span class="tag">tricks</span><span class="tag">1</span></a></div></div></div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/about/index/logo.svg" alt="Slack Ideas" height="28"></a><p class="is-size-7"><span>&copy; 2022 caiski</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("zh-CN");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "此网站使用Cookie来改善您的体验。",
          dismiss: "知道了！",
          allow: "允许使用Cookie",
          deny: "拒绝",
          link: "了解更多",
          policy: "Cookie政策",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script></body></html>